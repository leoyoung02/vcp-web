<div>
    <div class="flex items-center">
        <img 
            class="w-16 h-16 object-cover rounded-full mr-1.5 hover:cursor-pointer" 
            *ngIf="imageSrc" 
            [src]="imageSrc" 
            [alt]="username" 
            (mouseover)="toggleHover(true)" 
            (mouseleave)="toggleHover(false)"
            data-popover-target="popover-user-profile" 
            data-popover-placement="bottom" 
        />
        <button [routerLink]="['/users/notifications/', userid]" class="inline-flex items-center text-sm font-medium text-center text-gray-500 hover:text-gray-900 focus:outline-none dark:hover:text-white dark:text-gray-400" type="button"> 
            <svg class="ml-2 w-6 h-6 text-slate-600 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 21">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 3.464V1.1m0 2.365a5.338 5.338 0 0 1 5.133 5.368v1.8c0 2.386 1.867 2.982 1.867 4.175C15 15.4 15 16 14.462 16H1.538C1 16 1 15.4 1 14.807c0-1.193 1.867-1.789 1.867-4.175v-1.8A5.338 5.338 0 0 1 8 3.464ZM4.54 16a3.48 3.48 0 0 0 6.92 0H4.54Z"/>
            </svg>
            <div class="relative flex" *ngIf="notifications?.length > 0">
                <div class="relative inline-flex w-3 h-3 bg-white border-2 border-slate-600 rounded-full -top-2 right-3 dark:border-gray-900"></div>
            </div>
            <span class="text-slate-600 -ml-2">{{ notifications?.length > 0 ? notifications?.length : '' }}</span>
        </button>
    </div>
    <div data-popover 
        id="popover-user-profile" 
        role="tooltip"
        class="mt-2 absolute z-10 invisible inline-block text-sm text-gray-500 transition-opacity duration-300 bg-white rounded-lg shadow-sm opacity-0 w-80 dark:text-gray-400 dark:bg-gray-800 dark:border-gray-600">
        <div class="shadow">
            <div class="p-8 flex items-center rounded-t-lg">
                <div>
                    <img 
                        class="w-32 h32 object-cover rounded-full mr-7" 
                        *ngIf="imageSrc" 
                        [src]="imageSrc" 
                        [alt]="username"
                    />
                </div>
                <div>
                    <div class="text-black text-lg font-semibold">{{ username }}</div>
                    <div class="mt-2 opacity-60">{{ customMemberTypeName }}</div>
                </div>
            </div>
            <div>
                <div class="p-8 pt-0 pb-2">
                    <ng-container *ngIf="hasAccess('clubs') && myClubsTitle">
                        <div class="hover:cursor-pointer flex capitalize pb-4 items-center" [routerLink]="['/dashboard/5']">
                            <div>
                                <svg class="w-4 h-4 mr-4 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 18">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 3a3 3 0 1 1-1.614 5.53M15 12a4 4 0 0 1 4 4v1h-3.348M10 4.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0ZM5 11h3a4 4 0 0 1 4 4v2H1v-2a4 4 0 0 1 4-4Z"/>
                                </svg>
                            </div>
                            <div>{{ myClubsTitle }}</div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="hasAccess('plans') && myActivitiesTitle">
                        <div class="hover:cursor-pointer flex capitalize pb-4 items-center" [routerLink]="['/dashboard/1']">
                            <div>
                                <svg class="w-4 h-4 mr-4 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1v3m5-3v3m5-3v3M1 7h18M5 11h10M2 3h16a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1Z"/>
                                </svg>
                            </div>
                            <div>{{ myActivitiesTitle }}</div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="hasAccess('plans') && (canManageEvents || isAdmin)">
                        <div class="hover:cursor-pointer flex capitalize pb-4 items-center" routerLink="/users/admin-lists">
                            <div>
                                <svg class="w-4 h-4 mr-4 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                    <g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                                      <path d="M19 11V9a1 1 0 0 0-1-1h-.757l-.707-1.707.535-.536a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0l-.536.535L12 2.757V2a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v.757l-1.707.707-.536-.535a1 1 0 0 0-1.414 0L2.929 4.343a1 1 0 0 0 0 1.414l.536.536L2.757 8H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h.757l.707 1.707-.535.536a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l.536-.535L8 17.243V18a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-.757l1.707-.708.536.536a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-.535-.536.707-1.707H18a1 1 0 0 0 1-1Z"/>
                                      <path d="M10 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                                    </g>
                                </svg>
                            </div>
                            <div>{{ 'company-settings.managelanding' | translate}}</div>
                        </div>
                    </ng-container>
                </div>
            </div>
            <div [ngStyle]="{'background-color': buttonColor}" class="p-8">
                <ng-container *ngFor="let notification of popupNotifications">
                    <div class="flex mb-3">
                        <div class="mr-2">
                            <svg class="-mt-1.5 w-5 h-5 text-white dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 14 20">
                                <path d="M12.133 10.632v-1.8A5.406 5.406 0 0 0 7.979 3.57.946.946 0 0 0 8 3.464V1.1a1 1 0 0 0-2 0v2.364a.946.946 0 0 0 .021.106 5.406 5.406 0 0 0-4.154 5.262v1.8C1.867 13.018 0 13.614 0 14.807 0 15.4 0 16 .538 16h12.924C14 16 14 15.4 14 14.807c0-1.193-1.867-1.789-1.867-4.175ZM3.823 17a3.453 3.453 0 0 0 6.354 0H3.823Z"/>
                            </svg>
                        </div>
                        <div>
                            <div class="text-white -mt-2 text-xs">{{ language == 'en' ? notification?.message_en : notification.message }}</div>
                            <div class="text-white text-xs mt-2">{{ notification.created | dateAgo: (language || 'es') }}</div>
                        </div>
                    </div>
                </ng-container>
                <div 
                    class="text-white rounded-lg border border-white mt-8 mx-auto w-2/3 text-center p-2 uppercase text-sm font-semibold rounded-[15px] hover:cursor-pointer"
                    [ngStyle]="{'color': buttonColor, 'border-color': buttonColor}"
                    [routerLink]="['/users/notifications/', userid]"
                    *ngIf="notifications?.length > 0"
                  >
                    {{ 'notification-popup.viewall' | translate }}
                  </div>
            </div>
            <div class="rounded-b-lg p-6 px-12" [ngStyle]="{'background-color': '#1C393D'}">
                <div (click)="logout()" class="rounded-[15px] flex justify-center items-center hover:cursor-pointer text-center py-3" 
                    [ngStyle]="{'background-color': buttonColor}">
                    <svg class="w-5 h-5 text-white dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h11m0 0-4-4m4 4-4 4m-5 3H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h3"/>
                    </svg>
                    <span class="ml-2 text-white uppercase text-sm font-semibold">{{ 'sidebar.logout' | translate }}</span>
                </div>
            </div>
        </div>
    </div>
</div>